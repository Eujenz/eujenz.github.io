---
title: '智能影像檢測 - AOI介紹'
date: 2024-10-24T00:36:24+08:00
draft: false
tags: ["半導體物理與元件"]
summary: ""
categories: ["半導體物理與元件"]
showtoc: true  # 顯示目錄
tocopen: true  # 預設展開目錄
mathjax: true
---


## 自動光學檢測（AOI，Automated Optical Inspection）

AOI是一種透過光學影像技術自動檢測產品是否符合規範的技術，主要應用於半導體製程、印刷電路板（PCB）、電子元件等領域。AOI的基本原理是通過比對待測物的影像與標準影像，來檢測瑕疵或偏差，並依此判斷產品的品質。隨著技術的發展，AOI系統已經發展出1D、2D、3D視覺系統，並結合機器視覺，實現更高效和精確的自動化檢測。

### 1D視覺系統

1D視覺系統主要用於分析掃描線的數位訊號，而非觀察整個圖像。系統會逐條掃描，並將最新的數據與之前的數據進行比較，以檢測是否有缺陷或異常。該技術特別適合於連續生產的材料檢測，如紙張、金屬、塑膠或非紡織材料。1D視覺系統能夠有效地識別材料中的微小缺陷，並對缺陷進行分類。

#### 應用範圍：
- 紙張連續生產線
- 金屬薄片檢測
- 塑膠或其他連續製造材料的檢測

### 2D視覺系統

2D視覺系統是AOI檢測技術中最常見的技術之一，使用面陣掃描或線掃描技術來捕捉2D影像。面陣掃描系統能夠拍攝產品的2D快照，適合靜態或局部檢測。而線掃描系統逐條掃描產品表面，將數據拼接成完整的2D圖像。這些系統通常應用於高精度檢測場景，尤其是在檢測需要高解析度的產品時，例如印刷電路板（PCB）和精密電子元件。

#### 應用範圍：
- 印刷電路板（PCB）製造與檢測
- 精密電子元件的外觀檢測
- 平面結構產品的瑕疵檢測

### 3D視覺系統

3D視覺系統由多台相機或雷射位移感測器組成，這些設備能夠捕捉產品的3D資訊，如高度、深度和表面結構。3D視覺技術能夠捕捉產品的立體形狀，適合於需要高精度輪廓分析和體積測量的檢測應用中。這些系統能夠精確檢測產品的高度變化及表面不平整度，並且可以檢測複雜的立體結構，如芯片上的微小瑕疵。

#### 應用範圍：
- 測產品的高度或表面缺陷，例如芯片表面的瑕疵
- 對立體形狀產品的檢測，如精密機械元件
- 高精度的體積測量與檢測，尤其適合不規則形狀的元件

#### 優勢：
- 能提供產品的高度、深度及立體輪廓信息
- 特別適合不規則形狀或立體結構的元件檢測
- 可以應用於複雜的三維產品結構，如芯片、焊點等，提供高精度檢測結果

### 機器視覺

在機器視覺應用中，AOI技術結合了多台相機或光學設備，能夠檢測並對比元件的位置與方向，確保其安裝的準確性與角度。在2D或3D空間中，這些系統可以自動向機器人提供元件的精確定位信息，並將組件精確對位到指定位置。

#### 應用範例：
- 系統可以定義組件的位置和方向，並與標準規定的公差進行比較，確保組件的裝配是否正確。
- 機器視覺還需要圖案匹配技術來協助定位元件，特別是在應對角度或尺寸變化時。
- 引導系統中的機器視覺能夠將測量結果反饋給機器控制器，完成自動校準或調整。

#### 優勢：
- 高效的機器視覺系統可實現準確的組件定位與對位，減少人工干預
- 能應對較大的對比度變化、光線變化和角度旋轉等問題，保證測量準確性
- 適合於需要高精度定位的自動化生產線

## AOI硬體構成

![](/images/AOI01.png)

AOI系統的硬體由多個關鍵組件組成，這些部件密切協作，保證檢測過程的高效性和準確性。從上圖中我們可以看到，AOI硬體系統包括以下部分：

### 光源系統（Illumination）
光源的質量對影像的清晰度和對比度有著直接的影響，能夠確保檢測物體的每個細節被充分捕捉。光源通常包括LED光源和雷射光源，通過不同角度和波長的照射來減少陰影或光澤的干擾。

### 相機與鏡頭（Camera and Lens）
- **相機（Camera）**： 高解析度的相機負責捕捉待測物的影像。相機解析度越高，檢測到的細節越多，能夠精確檢測到微小的瑕疵。
- **鏡頭（Lens）**： 鏡頭則幫助精確對焦待測物，確保拍攝到的影像清晰且無失真。不同焦距和類型的鏡頭會根據檢測對象進行選擇，以滿足特定的檢測需求。

### 微處理器（Microprocessor）
微處理器是AOI系統的核心，負責處理來自相機的影像數據，並進行必要的數據運算。這一過程中涉及大量的影像預處理（Preprocessing）和演算法分析，這是AOI檢測系統快速、精確運作的關鍵。

### 影像處理和分析（Image Processing and Algorithms）
檢測到的影像經過預處理後，進一步通過專業的軟體工具和演算法進行分析，以比對標準範本並檢測是否有瑕疵。演算法會對影像中的缺陷進行分類，並決定是否符合規範。這個過程通常涉及形狀識別、尺寸測量、對比分析等技術。

### 顯示與報告系統（Display and Reporting）
檢測結果會以圖像或數據報表的形式即時呈現給操作員，系統會自動將檢測過程中的NG（不良品）和OK（合格品）進行分類，並輸出結果文件（如圖中顯示的CSV文件格式），以便進行品質追蹤或進一步分析。

### AOI硬體系統的運作流程

- **影像構成（Image Formation）**： 光源系統提供照明，相機與鏡頭捕捉目標物的清晰影像。
- **影像捕捉（Image Capture）**： 捕捉到的影像傳送至微處理器進行數據分析。
- **影像預處理（Image Preprocessing）**： 影像經過預處理，去除噪點，強化對比度等操作。
- **影像分析（Image Processing）**： 使用演算法對影像進行比對，判斷瑕疵並分類。
- **結果呈現（Result Display）**： 將結果以即時顯示方式呈現給操作員，並生成報告文件供後續使用。

## FOV、WD 和感光元件尺寸的關係
在選擇AOI系統的相機及鏡頭時，必須根據產品的檢測需求和特性綜合考慮FOV、WD、感光元件大小、焦距以及解析度。視野範圍決定了相機能夠觀察到的範圍，工作距離則影響成像的細節程度。根據具體應用，應合理平衡視野與解析度之間的關係，確保檢測的效率和準確性。

### 視野範圍（Field of View, FOV）
FOV 是指相機能夠觀察到的範圍，FOV 越大，所能覆蓋的區域越廣。在AOI檢測中，FOV 決定了每次拍攝所能檢測的範圍。如果FOV過小，可能需要進行多次拍攝來檢測整個物件，這會降低檢測效率；而FOV過大則可能導致影像解析度不足，無法檢測出細微瑕疵。

### 工作距離（Working Distance, WD）
WD 是指相機鏡頭與待測物之間的距離。WD 與 FOV 直接相關：當WD增加時，FOV也會增大，即相機能看到的範圍會更廣。但如果WD過大，影像解析度會隨之降低，這是因為光線的衰減和鏡頭的解析度限制。

### 感光元件大小（Sensor Size）與焦距（Focal Length, FL）
FOV、WD與感光元件的大小和鏡頭的焦距密切相關。感光元件越大，所能捕捉的影像越大，這有助於增大視野範圍。焦距越短，視野越寬，這是廣角鏡頭的特性；反之，焦距越長，視野範圍越窄，但能觀察到更細的細節。

#### 重要計算公式：

-  **FOV的計算公式**：
   $$
   FOV = \left( \frac{Sensor\ Size \times WD}{Lens\ Focal\ Length (FL)} \right)
   $$

> 這個公式顯示了感光元件尺寸、工作距離和鏡頭焦距之間的關係。當鏡頭的焦距（FL）增加時，FOV會縮小；當WD或感光元件尺寸增加時，FOV會變大。

- **倍率（Magnification）公式**：
   $$
   倍率 = \left( \frac{Sensor\ Size}{FOV} \right)
   $$


> 當FOV變大時，倍率會變小，這意味着影像中的物體會變小。

- **解析度（Accuracy）計算**：
   $$
   Accuracy = \left( \frac{Pixel\ Size (Sensor)}{Lens\ 倍率} \right)
   $$

> 解析度決定了檢測系統能夠分辨的最小細節。像素大小越小，解析度越高；鏡頭的倍率越大，影像的細節表現也會越好。

#### 應用範例：

- **大型物件的檢測**： 如果需要檢測較大的產品，應選擇較大的FOV和適中的WD，以確保可以一次性拍攝到整個待測物。同時，感光元件的尺寸應選擇較大，以保證影像清晰。
   
- **高精度檢測**： 如果檢測細小的瑕疵或高精度零件（如半導體晶片），則需要較小的FOV、高解析度的相機以及較短的WD來獲得清晰的細節影像。

### 鏡頭的放大倍率與工作距離：

圖中利用三角幾何來解釋鏡頭放大倍率的計算。放大倍率（a）與物距（u）和像距（v）的比例關係如下：
$$
a = \frac{d}{D} = \frac{v}{u}
$$

如果鏡頭焦距為100 mm，且工作距離（WD）為200 mm，則放大倍率為2倍（倍率 = 2X）。這意味著影像放大後可以觀察到更細小的物體細節。

### 基本成像原理

成像系統遵循的基本光學規律是成像公式：
$$
\frac{1}{f} = \frac{1}{u} + \frac{1}{v}
$$
其中 $f$ 為鏡頭焦距，$u$ 為物距，$v$ 為像距。這個公式解釋了物體在鏡頭前成像的基本原理。



### 景深（Depth of Field, DOF）

 DOF是指物體在鏡頭焦距範圍內保持清晰的深度範圍。DOF越大，意味著待測物的表面即使存在高度差異也能保持清晰成像。DOF受到焦距、光圈和WD的影響。當使用較小的光圈（大光圈數值）時，景深會增加。


#### 景深影響因素：

1. **鏡頭的焦距（focal length, f）**：
   焦距越長，景深越淺。因此，長焦距鏡頭通常更適合對於單一平面進行精密檢測，而短焦距鏡頭則適合需要更大景深的應用場景。

2. **光圈值（Aperture, N）**：
   光圈越大（f數字越小），景深越淺；光圈越小（f數字越大），景深越大。因此，在需要更大景深的情況下，應使用較小的光圈。

3. **模糊圈直徑（Circle of Confusion, C）**：
   這是影像中可接受的模糊量。C值越大，景深越小；C值越小，景深越大。這在高解析度影像中特別重要，因為高精度影像要求非常小的C值，從而減少模糊度。

4. **物距（Working Distance, WD）**：
   距離鏡頭越近，景深越淺；距離鏡頭越遠，景深越大。因此，鏡頭與物體的距離會顯著影響檢測時影像的清晰度。

#### 公式解釋：

1. **景深上限（DN）**：
   $$
   DN = \frac{H \cdot (H - f)}{2H - 2f}
   $$
   此公式表示最近的清晰聚焦點到焦點之間的距離，即景深的下限。這裡的 $H$ 是超焦距，$f$ 是焦距。

2. **景深下限（DF）**：
   當 $DF = ∞$ 時，表示遠端的景深可以達到無限遠，這意味著所有更遠的物體都會保持清晰。

3. **超焦距（Hyperfocal Distance, H）**：
   超焦距是指當鏡頭聚焦在無限遠時，從一個有限的距離到無限遠都能保持清晰。這是景深的重要概念，決定了遠處物體的清晰範圍。

#### 應用場景：

1. **高精度檢測**：
   當檢測對象需要保持較大範圍內的清晰度時（如較大的PCB板或需要多層結構的檢測），需要更大的景深。這時可以使用短焦距的鏡頭或調整光圈來增加景深。

2. **微小物件檢測**：
   當需要檢測非常細小的元件時，通常需要更小的景深以專注於單一平面或區域，這可以透過使用長焦距鏡頭來實現。







